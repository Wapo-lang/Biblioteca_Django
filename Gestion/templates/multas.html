{% extends "index.html" %}
{% block contenido %}
<div class="container mt-4">
    <h2 class="library-title">üí∞ Gesti√≥n de Multas</h2>

    {% if pendientes %}
    <div class="alert alert-warning border-warning">
        <h5>‚ö†Ô∏è Pr√©stamos con Retraso Detectados</h5>
        <table class="table table-sm">
            <thead>
                <tr>
                    <th>Libro</th>
                    <th>Usuario</th>
                    <th>D√≠as de retraso</th>
                    <th>Acci√≥n</th>
                </tr>
            </thead>
            <tbody>
                {% for p in pendientes %}
                <tr>
                    <td>{{ p.libro.titulo }}</td>
                    <td>{{ p.usuario.username }}</td>
                    <td><span class="badge bg-danger">{{ p.dias_retraso }} d√≠as</span></td>
                    <td>
                        <a href="{% url 'crear_multa' p.id %}" class="btn btn-sm btn-dark">Procesar Multa</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}

    <div class="library-card mt-4">
        <h4>Historial de Sanciones</h4>
        <table class="table">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Socio</th>
                    <th>Motivo</th>
                    <th>Monto</th>
                    <th>Estado</th>
                </tr>
            </thead>
            <tbody>
                {% for multa in multas %}
                <tr>
                    <td>{{ multa.fecha }}</td>
                    <td>{{ multa.prestamo.usuario.username }}</td>
                    <td>{{ multa.get_tipo_multa_display }}</td>
                    <td>${{ multa.monto }}</td>
                    <td>
                        {% if multa.pagada %}
                            <span class="badge bg-success">Pagada</span>
                        {% else %}
                            <span class="badge bg-outline-danger">Pendiente</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}